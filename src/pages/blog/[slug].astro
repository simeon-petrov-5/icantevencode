---
import Blogpostlayout from "src/layouts/blogpost.astro";
import { ArticleDetails, fetchBlocks, fetchArticles } from "src/utils/notion";
import BlocksRenderer from "@components/blog/BlocksRenderer.astro";
import BlogleHeader from "@components/blog/BlogHeader.astro";

export async function getStaticPaths() {
  // const articles = await Astro.glob("../../articles/*.md");
  const articles = await fetchArticles();

  return articles.map((article) => ({
    params: {
      slug: article.slug,
    },
    props: {
      article,
    },
  }));
}

const article = Astro.props.article as ArticleDetails;

const blocks = await fetchBlocks(article.id);
---

<Blogpostlayout title={article.title} description={article.excerpt} slug={article.slug}>
  <BlogleHeader data={article} />
  <BlocksRenderer title={article.title} items={blocks} />
</Blogpostlayout>

